{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>{% block title %}Super Admin - Enpower Skill Lab{% endblock %}</title>

    <!-- Preload critical fonts for faster loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        rel="stylesheet" />

    <!-- Prevent FOUC (Flash of Unstyled Content) for Material Icons -->
    <style>
        .material-symbols-outlined {
            font-family: 'Material Symbols Outlined';
            font-weight: normal;
            font-style: normal;
            font-size: 24px;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            display: inline-block;
            white-space: nowrap;
            word-wrap: normal;
            direction: ltr;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            font-feature-settings: 'liga';
            /* Hide text until font loads */
            overflow: hidden;
            width: 24px;
            height: 24px;
        }
    </style>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/superadmin/sup-admin-dash.css' %}">

    {% block extra_css %}{% endblock %}
</head>

<body>
    <div class="dashboard-container">
        <!-- Mobile sidebar overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <img src="{% static 'assets/images/enpower-logo (1).png' %}" alt="Enpower Logo" class="sidebar-logo" />
                <button id="closeSidebar" class="sidebar-close">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <nav class="sidebar-nav">
                <p class="menu-label">menu</p>

                <!-- Dashboard -->
                <a href="{% url 'superadmin_dashboard' %}" id="nav-dashboard" class="sidebar-nav-link">
                    <span class="material-symbols-outlined">dashboard</span>
                    Dashboard
                </a>

                <!-- Schools -->
                <div class="sidebar-dropdown">
                    <a href="#" class="sidebar-dropdown-toggle" id="schools-dropdown">
                        <span class="material-symbols-outlined">school</span>
                        Schools
                        <span class="material-symbols-outlined dropdown-icon">expand_more</span>
                    </a>
                    <div class="sidebar-dropdown-menu">
                        <a href="{% url 'school_list' %}" id="nav-school-list">
                            <span class="material-symbols-outlined">list</span>
                            School List
                        </a>
                        <a href="{% url 'onboard_school' %}" id="nav-add-school">
                            <span class="material-symbols-outlined">add_business</span>
                            Onboard School
                        </a>
                        <a href="school-details.html" id="nav-school-details">
                            <span class="material-symbols-outlined">info</span>
                            School Details
                        </a>
                    </div>
                </div>

                <!-- Users -->
                <div class="sidebar-dropdown">
                    <a href="#" class="sidebar-dropdown-toggle" id="users-dropdown">
                        <span class="material-symbols-outlined">group</span>
                        Users
                        <span class="material-symbols-outlined dropdown-icon">expand_more</span>
                    </a>
                    <div class="sidebar-dropdown-menu">
                        <a href="{% url 'school_admin_list' %}" id="nav-school-admins">
                            <span class="material-symbols-outlined">admin_panel_settings</span>
                            School Admins
                        </a>
                        <a href="{% url 'onboard_school_admin' %}" id="nav-add-school-admins">
                            <span class="material-symbols-outlined">person_add</span>
                            Onboard School Admins
                        </a>
                        <a href="{% url 'coordinator_list' %}" id="nav-program-coordinators">
                            <span class="material-symbols-outlined">supervisor_account</span>
                            Program Coordinators
                        </a>
                        <a href="{% url 'onboard_coordinator' %}" id="nav-add-program-coordinators">
                            <span class="material-symbols-outlined">person_add</span>
                            Onboard Program Coordinators
                        </a>
                        <a href="{% url 'teacher_list' %}" id="nav-thinking-coaches">
                            <span class="material-symbols-outlined">psychology</span>
                            Thinking Coaches
                        </a>
                        <a href="{% url 'onboard_teacher' %}" id="nav-add-thinking-coaches">
                            <span class="material-symbols-outlined">person_add</span>
                            Onboard Thinking Coaches
                        </a>
                        <a href="{% url 'student_list' %}" id="nav-students-list">
                            <span class="material-symbols-outlined">school</span>
                            Students List
                        </a>
                        <a href="{% url 'onboard_student' %}" id="nav-add-student">
                            <span class="material-symbols-outlined">person_add</span>
                            Onboard Student
                        </a>
                        <a href="{% url 'parent_list' %}" id="nav-parent-list">
                            <span class="material-symbols-outlined">family_restroom</span>
                            Parent List
                        </a>
                        <a href="{% url 'onboard_parent' %}" id="nav-add-parent">
                            <span class="material-symbols-outlined">person_add</span>
                            Onboard Parent
                        </a>
                        <a href="bulk-upload.html" id="nav-bulk-upload">
                            <span class="material-symbols-outlined">upload_file</span>
                            Bulk Upload / Manage Users
                        </a>
                    </div>
                </div>

                <!-- Classes -->
                <div class="sidebar-dropdown">
                    <a href="#" class="sidebar-dropdown-toggle" id="classes-dropdown">
                        <span class="material-symbols-outlined">class</span>
                        Classes
                        <span class="material-symbols-outlined dropdown-icon">expand_more</span>
                    </a>
                    <div class="sidebar-dropdown-menu">
                        <a href="{% url 'class_list' %}" id="nav-class-list">
                            <span class="material-symbols-outlined">list</span>
                            Class List
                        </a>
                        <a href="{% url 'add_class' %}" id="nav-add-class">
                            <span class="material-symbols-outlined">add</span>
                            Add Class
                        </a>
                        {% comment %} <a href="bulk-import-classes.html" id="nav-bulk-import-classes">
                            <span class="material-symbols-outlined">upload_file</span>
                            Bulk Import Classes
                        </a> {% endcomment %}
                        {% comment %} <a href="archive-classes.html" id="nav-archive-classes">
                            <span class="material-symbols-outlined">archive</span>
                            Archive Classes
                        </a> {% endcomment %}
                    </div>
                </div>

                <!-- Academics -->
                <div class="sidebar-dropdown">
                    <a href="#" class="sidebar-dropdown-toggle" id="academics-dropdown">
                        <span class="material-symbols-outlined">menu_book</span>
                        Academics
                        <span class="material-symbols-outlined dropdown-icon">expand_more</span>
                    </a>
                    <div class="sidebar-dropdown-menu">
                        <a href="learning-pillars.html" id="nav-learning-pillars">
                            <span class="material-symbols-outlined">account_tree</span>
                            Learning Pillars
                        </a>
                        <a href="competencies.html" id="nav-competencies">
                            <span class="material-symbols-outlined">workspace_premium</span>
                            Competencies
                        </a>
                        <a href="profiles.html" id="nav-profiles">
                            <span class="material-symbols-outlined">badge</span>
                            Profiles
                        </a>
                        <a href="weightage-mapping.html" id="nav-weightage-mapping">
                            <span class="material-symbols-outlined">functions</span>
                            Weightage Mapping (Grade-wise)
                        </a>
                        <a href="academic-year-locking.html" id="nav-academic-year-locking">
                            <span class="material-symbols-outlined">lock</span>
                            Academic Year Locking
                        </a>
                    </div>
                </div>

                <!-- LMS Management -->
                <div class="sidebar-dropdown">
                    <a href="#" class="sidebar-dropdown-toggle" id="lms-dropdown">
                        <span class="material-symbols-outlined">library_books</span>
                        LMS Management
                        <span class="material-symbols-outlined dropdown-icon">expand_more</span>
                    </a>
                    <div class="sidebar-dropdown-menu">
                        <a href="{% url 'lesson_list' %}" id="nav-lessons-library">
                            <span class="material-symbols-outlined">auto_stories</span>
                            Lessons Library
                        </a>
                        <a href="{% url 'add_lesson' %}" id="nav-add-lesson">
                            <span class="material-symbols-outlined">note_add</span>
                            Add Lesson
                        </a>
                        <a href="categories-modules.html" id="nav-categories-modules">
                            <span class="material-symbols-outlined">category</span>
                            Categories & Modules
                        </a>
                    </div>
                </div>

                <!-- Monitoring -->
                <div class="sidebar-dropdown">
                    <a href="#" class="sidebar-dropdown-toggle" id="monitoring-dropdown">
                        <span class="material-symbols-outlined">monitoring</span>
                        Monitoring
                        <span class="material-symbols-outlined dropdown-icon">expand_more</span>
                    </a>
                    <div class="sidebar-dropdown-menu">
                        <a href="assessment-monitoring.html" id="nav-assessment-monitoring">
                            <span class="material-symbols-outlined">assignment_turned_in</span>
                            Assessment Monitoring
                        </a>
                        <a href="attendance-monitoring.html" id="nav-attendance-monitoring">
                            <span class="material-symbols-outlined">fact_check</span>
                            Attendance Monitoring
                        </a>
                        <a href="lms-monitoring.html" id="nav-lms-monitoring">
                            <span class="material-symbols-outlined">monitor</span>
                            LMS Monitoring
                        </a>
                        <a href="multi-school-comparison.html" id="nav-multi-school-comparison">
                            <span class="material-symbols-outlined">compare</span>
                            Multi-school Comparison
                        </a>
                    </div>
                </div>

                <!-- Reports & Analytics -->
                <div class="sidebar-dropdown">
                    <a href="#" class="sidebar-dropdown-toggle" id="reports-dropdown">
                        <span class="material-symbols-outlined">analytics</span>
                        Reports & Analytics
                        <span class="material-symbols-outlined dropdown-icon">expand_more</span>
                    </a>
                    <div class="sidebar-dropdown-menu">
                        <a href="platform-analytics.html" id="nav-platform-analytics">
                            <span class="material-symbols-outlined">insights</span>
                            Platform Analytics
                        </a>
                        <a href="download-reports.html" id="nav-download-reports">
                            <span class="material-symbols-outlined">file_download</span>
                            Download Reports
                        </a>
                    </div>
                </div>

                <!-- Settings -->
                <div class="sidebar-dropdown">
                    <a href="#" class="sidebar-dropdown-toggle" id="settings-dropdown">
                        <span class="material-symbols-outlined">settings</span>
                        Settings
                        <span class="material-symbols-outlined dropdown-icon">expand_more</span>
                    </a>
                    <div class="sidebar-dropdown-menu">
                        <a href="system-settings.html" id="nav-system-settings">
                            <span class="material-symbols-outlined">tune</span>
                            System Settings
                        </a>
                        <a href="terms-privacy.html" id="nav-terms-privacy">
                            <span class="material-symbols-outlined">policy</span>
                            T&C / Privacy Policy
                        </a>
                        <a href="billing.html" id="nav-billing">
                            <span class="material-symbols-outlined">payments</span>
                            Billing (if needed)
                        </a>
                    </div>
                </div>

                <!-- My Account -->
                <div class="sidebar-dropdown">
                    <a href="#" class="sidebar-dropdown-toggle" id="account-dropdown">
                        <span class="material-symbols-outlined">account_circle</span>
                        My Account
                        <span class="material-symbols-outlined dropdown-icon">expand_more</span>
                    </a>
                    <div class="sidebar-dropdown-menu">
                        <a href="{% url 'superadmin_profile' %}" id="nav-profile">
                            <span class="material-symbols-outlined">person</span>
                            Profile
                        </a>
                        <a href="{% url 'superadmin_change_password' %}" id="nav-change-password">
                            <span class="material-symbols-outlined">lock</span>
                            Change Password
                        </a>
                        <a href="{% url 'superadmin_logout' %}" id="nav-logout">
                            <span class="material-symbols-outlined">logout</span>
                            Logout
                        </a>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <button id="menuToggle">
                        <span class="material-symbols-outlined">menu</span>
                    </button>
                    <button class="fullscreen-btn">
                        <span class="material-symbols-outlined">fullscreen</span>
                    </button>
                </div>
                <div class="header-right">
                    <div class="notification-wrapper">
                        <button id="notificationToggle">
                            <span class="material-symbols-outlined">notifications</span>
                        </button>
                        <span class="notification-badge">4</span>

                        <!-- Notification Dropdown Menu -->
                        <div class="notification-dropdown-menu" id="notificationDropdownMenu">
                            <div class="notification-dropdown-header">
                                <h4 class="notification-dropdown-title">Notifications</h4>
                                <span class="notification-count">4 new</span>
                            </div>
                            <div class="notification-dropdown-body">
                                <a href="#" class="notification-item unread">
                                    <div class="notification-icon bg-blue">
                                        <span class="material-symbols-outlined">assignment</span>
                                    </div>
                                    <div class="notification-content">
                                        <p class="notification-text"><strong>New Assignment Posted</strong></p>
                                        <p class="notification-description">Mathematics homework due by Friday</p>
                                        <span class="notification-time">10 minutes ago</span>
                                    </div>
                                </a>

                                <a href="#" class="notification-item unread">
                                    <div class="notification-icon bg-green">
                                        <span class="material-symbols-outlined">grade</span>
                                    </div>
                                    <div class="notification-content">
                                        <p class="notification-text"><strong>Grade Published</strong></p>
                                        <p class="notification-description">Your Science test results are available</p>
                                        <span class="notification-time">2 hours ago</span>
                                    </div>
                                </a>

                                <a href="#" class="notification-item unread">
                                    <div class="notification-icon bg-orange">
                                        <span class="material-symbols-outlined">event</span>
                                    </div>
                                    <div class="notification-content">
                                        <p class="notification-text"><strong>Upcoming Test</strong></p>
                                        <p class="notification-description">History exam scheduled for next Monday</p>
                                        <span class="notification-time">4 hours ago</span>
                                    </div>
                                </a>

                                <a href="#" class="notification-item unread">
                                    <div class="notification-icon bg-purple">
                                        <span class="material-symbols-outlined">emoji_events</span>
                                    </div>
                                    <div class="notification-content">
                                        <p class="notification-text"><strong>Achievement Unlocked</strong></p>
                                        <p class="notification-description">You earned a Perfect Attendance badge!</p>
                                        <span class="notification-time">1 day ago</span>
                                    </div>
                                </a>
                            </div>
                            <div class="notification-dropdown-footer">
                                <a href="#" class="notification-footer-link">View All Notifications</a>
                            </div>
                        </div>
                    </div>
                    <div class="user-info-wrapper">
                        <div class="user-info" id="userInfoToggle">
                            {% if user.superadmin_profile and user.superadmin_profile.profile_photo %}
                                <img alt="{{ user.get_full_name|default:user.username }}'s avatar" class="user-avatar"
                                    src="{{ user.superadmin_profile.profile_photo.url }}" />
                            {% else %}
                                <img alt="{{ user.get_full_name|default:user.username }}'s avatar" class="user-avatar"
                                    src="{% static 'assets/images/default-avatar.png' %}"
                                    onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22><rect fill=%22%236b277e%22 width=%22100%22 height=%22100%22/><text fill=%22white%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22 font-size=%2240%22 font-family=%22Arial%22>{{ user.first_name|first|default:user.username|first|upper }}</text></svg>'" />
                            {% endif %}
                            <span class="user-name">{% if user.superadmin_profile %}{{ user.superadmin_profile.full_name|default:user.get_full_name|default:user.username }}{% else %}{{ user.get_full_name|default:user.username }}{% endif %}</span>
                            <span class="material-symbols-outlined user-dropdown">expand_more</span>
                        </div>

                        <!-- User Dropdown Menu -->
                        <div class="user-dropdown-menu" id="userDropdownMenu" style="width: auto;">
                            <div class="dropdown-header">
                                {% if user.superadmin_profile and user.superadmin_profile.profile_photo %}
                                    <img alt="{{ user.get_full_name|default:user.username }}'s avatar" class="dropdown-avatar"
                                        src="{{ user.superadmin_profile.profile_photo.url }}" />
                                {% else %}
                                    <img alt="{{ user.get_full_name|default:user.username }}'s avatar" class="dropdown-avatar"
                                        src="{% static 'assets/images/default-avatar.png' %}"
                                        onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22><rect fill=%22%236b277e%22 width=%22100%22 height=%22100%22/><text fill=%22white%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22 font-size=%2240%22 font-family=%22Arial%22>{{ user.first_name|first|default:user.username|first|upper }}</text></svg>'" />
                                {% endif %}
                                <div class="dropdown-user-info">
                                    <h4 class="dropdown-user-name">{% if user.superadmin_profile %}{{ user.superadmin_profile.full_name|default:user.get_full_name|default:user.username }}{% else %}{{ user.get_full_name|default:user.username }}{% endif %}</h4>
                                    <p class="dropdown-user-email">{{ user.email }}</p>
                                </div>
                            </div>
                            <div class="dropdown-divider"></div>
                            <a href="{% url 'superadmin_profile' %}" class="dropdown-item" id="profileBtn">
                                <span class="material-symbols-outlined">account_circle</span>
                                <span>My Profile</span>
                            </a>
                            <a href="account-settings.html" class="dropdown-item" id="accountSettingsBtn">
                                <span class="material-symbols-outlined">settings</span>
                                <span>Account Settings</span>
                            </a>
                            <a href="{% url 'superadmin_dashboard' %}" class="dropdown-item">
                                <span class="material-symbols-outlined">dashboard</span>
                                <span>Dashboard</span>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="{% url 'superadmin_logout' %}" class="dropdown-item logout-item" id="logoutBtn">
                                <span class="material-symbols-outlined">logout</span>
                                <span>Logout</span>
                            </a>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Enhanced Django Messages Display -->
            {% if messages %}
            <div class="toast-container">
                {% for message in messages %}
                <div class="toast toast-{{ message.tags }}" data-toast>
                    <div class="toast-icon">
                        <span class="material-symbols-outlined">
                            {% if message.tags == 'success' %}check_circle{% elif message.tags == 'error' %}cancel{% elif message.tags == 'warning' %}warning{% else %}info{% endif %}
                        </span>
                    </div>
                    <div class="toast-content">
                        <div class="toast-title">
                            {% if message.tags == 'success' %}Success{% elif message.tags == 'error' %}Error{% elif message.tags == 'warning' %}Warning{% else %}Info{% endif %}
                        </div>
                        <div class="toast-message">{{ message }}</div>
                    </div>
                    <button class="toast-close" onclick="closeToast(this)">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                    <div class="toast-progress">
                        <div class="toast-progress-bar"></div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <style>
                .toast-container {
                    position: fixed;
                    top: 90px;
                    right: 24px;
                    z-index: 9999;
                    display: flex;
                    flex-direction: column;
                    gap: 12px;
                    max-width: 420px;
                    width: 100%;
                }
                
                .toast {
                    display: flex;
                    align-items: flex-start;
                    gap: 14px;
                    padding: 16px 18px;
                    background: #ffffff;
                    border-radius: 12px;
                    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12), 0 2px 8px rgba(0, 0, 0, 0.08);
                    position: relative;
                    overflow: hidden;
                    animation: toastSlideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
                    border-left: 4px solid;
                }
                
                .toast-success {
                    border-left-color: #10b981;
                }
                
                .toast-error {
                    border-left-color: #ef4444;
                }
                
                .toast-warning {
                    border-left-color: #f59e0b;
                }
                
                .toast-info {
                    border-left-color: #3b82f6;
                }
                
                .toast-icon {
                    width: 40px;
                    height: 40px;
                    border-radius: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    flex-shrink: 0;
                }
                
                .toast-success .toast-icon {
                    background: rgba(16, 185, 129, 0.12);
                    color: #10b981;
                }
                
                .toast-error .toast-icon {
                    background: rgba(239, 68, 68, 0.12);
                    color: #ef4444;
                }
                
                .toast-warning .toast-icon {
                    background: rgba(245, 158, 11, 0.12);
                    color: #f59e0b;
                }
                
                .toast-info .toast-icon {
                    background: rgba(59, 130, 246, 0.12);
                    color: #3b82f6;
                }
                
                .toast-icon .material-symbols-outlined {
                    font-size: 22px;
                    font-variation-settings: 'FILL' 1;
                }
                
                .toast-content {
                    flex: 1;
                    min-width: 0;
                }
                
                .toast-title {
                    font-weight: 600;
                    font-size: 15px;
                    color: #1f2937;
                    margin-bottom: 4px;
                }
                
                .toast-message {
                    font-size: 14px;
                    color: #6b7280;
                    line-height: 1.5;
                    word-wrap: break-word;
                }
                
                .toast-close {
                    background: none;
                    border: none;
                    padding: 4px;
                    cursor: pointer;
                    color: #9ca3af;
                    border-radius: 6px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: all 0.2s ease;
                    flex-shrink: 0;
                }
                
                .toast-close:hover {
                    background: #f3f4f6;
                    color: #4b5563;
                }
                
                .toast-close .material-symbols-outlined {
                    font-size: 20px;
                }
                
                .toast-progress {
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    right: 0;
                    height: 4px;
                    background: rgba(0, 0, 0, 0.06);
                }
                
                .toast-progress-bar {
                    height: 100%;
                    width: 100%;
                    animation: progressShrink 5s linear forwards;
                }
                
                .toast-success .toast-progress-bar {
                    background: linear-gradient(90deg, #10b981, #34d399);
                }
                
                .toast-error .toast-progress-bar {
                    background: linear-gradient(90deg, #ef4444, #f87171);
                }
                
                .toast-warning .toast-progress-bar {
                    background: linear-gradient(90deg, #f59e0b, #fbbf24);
                }
                
                .toast-info .toast-progress-bar {
                    background: linear-gradient(90deg, #3b82f6, #60a5fa);
                }
                
                @keyframes toastSlideIn {
                    from {
                        transform: translateX(120%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
                
                @keyframes toastSlideOut {
                    from {
                        transform: translateX(0);
                        opacity: 1;
                    }
                    to {
                        transform: translateX(120%);
                        opacity: 0;
                    }
                }
                
                @keyframes progressShrink {
                    from {
                        width: 100%;
                    }
                    to {
                        width: 0%;
                    }
                }
                
                .toast.closing {
                    animation: toastSlideOut 0.3s ease-out forwards;
                }
                
                /* Dark mode support */
                body.dark .toast {
                    background: #1f2937;
                    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
                }
                
                body.dark .toast-title {
                    color: #f9fafb;
                }
                
                body.dark .toast-message {
                    color: #9ca3af;
                }
                
                body.dark .toast-close {
                    color: #6b7280;
                }
                
                body.dark .toast-close:hover {
                    background: #374151;
                    color: #d1d5db;
                }
                
                body.dark .toast-progress {
                    background: rgba(255, 255, 255, 0.1);
                }
                
                /* Mobile responsive */
                @media (max-width: 480px) {
                    .toast-container {
                        right: 12px;
                        left: 12px;
                        max-width: none;
                    }
                }
            </style>
            <script>
                function closeToast(button) {
                    const toast = button.closest('.toast');
                    toast.classList.add('closing');
                    setTimeout(() => toast.remove(), 300);
                }
                
                // Auto-dismiss toasts after 5 seconds
                document.querySelectorAll('[data-toast]').forEach(function(toast, index) {
                    setTimeout(function() {
                        if (toast.parentElement) {
                            toast.classList.add('closing');
                            setTimeout(() => toast.remove(), 300);
                        }
                    }, 5000 + (index * 200)); // Stagger removal for multiple toasts
                });
                
                // Pause progress bar on hover
                document.querySelectorAll('.toast').forEach(function(toast) {
                    const progressBar = toast.querySelector('.toast-progress-bar');
                    
                    toast.addEventListener('mouseenter', function() {
                        if (progressBar) {
                            progressBar.style.animationPlayState = 'paused';
                        }
                    });
                    
                    toast.addEventListener('mouseleave', function() {
                        if (progressBar) {
                            progressBar.style.animationPlayState = 'running';
                        }
                    });
                });
            </script>
            {% endif %}

            {% block content %}
            {% endblock %}
        </main>
    </div>

    <!-- JavaScript -->
    <script src="{% static 'js/superadmin/sup-admin-dash.js' %}"></script>
    
    <!-- Universal Active State Handler -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get current URL path
            const currentPath = window.location.pathname;
            
            // Find all sidebar links and check if their href matches current path
            const allSidebarLinks = document.querySelectorAll('.sidebar-nav a[href], .sidebar-dropdown-menu a[href]');
            
            allSidebarLinks.forEach(link => {
                const linkPath = link.getAttribute('href');
                
                // Check if link href matches current path
                if (linkPath && (linkPath === currentPath || linkPath === currentPath.replace(/\/$/, '') || linkPath + '/' === currentPath)) {
                    link.classList.add('active');
                    
                    // If inside dropdown menu, also activate parent
                    const parentDropdown = link.closest('.sidebar-dropdown');
                    if (parentDropdown) {
                        parentDropdown.classList.add('active');
                        const dropdownToggle = parentDropdown.querySelector('.sidebar-dropdown-toggle');
                        if (dropdownToggle) {
                            dropdownToggle.classList.add('active');
                        }
                    }
                }
            });
        });
    </script>
    
    <!-- Logout Handler (inline to avoid caching issues) -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const logoutUrl = '{% url "superadmin_logout" %}';
            
            // Header logout
            const headerLogout = document.getElementById('logoutBtn');
            if (headerLogout) {
                headerLogout.onclick = function(e) {
                    e.preventDefault();
                    if (confirm('Are you sure you want to logout?')) {
                        window.location.href = logoutUrl;
                    }
                    return false;
                };
            }
            
            // Sidebar logout
            const sidebarLogout = document.getElementById('nav-logout');
            if (sidebarLogout) {
                sidebarLogout.onclick = function(e) {
                    e.preventDefault();
                    if (confirm('Are you sure you want to logout?')) {
                        window.location.href = logoutUrl;
                    }
                    return false;
                };
            }
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>

</html>
